# 移动端图片格式调研

> 文摘来源：[ibireme 的博客：《移动端图片格式调研》](https://blog.ibireme.com/2015/11/02/mobile_image_benchmark/)，有增删。

图片通常是移动端流量耗费最多的部分，并且占据着重要的视觉空间。合理的图片格式选用和优化可以为你节省带宽、提升视觉效果。在这篇文章里我会分析一下目前主流和新兴的几种图片格式的特点、性能分析、参数调优，以及相关开源库的选择。

<h2>目录</h2>

- [移动端图片格式调研](#移动端图片格式调研)
  - [老牌的图片格式](#老牌的图片格式)
    - [GIF](#gif)
    - [JPEG](#jpeg)
    - [PNG](#png)
  - [新兴的图片格式](#新兴的图片格式)
    - [APNG](#apng)
    - [WebP](#webp)
    - [BPG](#bpg)

## 老牌的图片格式

首先谈一下大家耳熟能详的几种老牌的图片格式吧：

### GIF

GIF 诞生于 **1987** 年，随着初代互联网流行开来。它有很多缺点，比如通常情况下**只支持 256 种颜色、透明通道只有 1 bit、文件压缩比不高**。它**唯一的优势就是支持多帧动画**，凭借这个特性，它得以从 Windows 1.0 时代流行至今，而且仍然大受欢迎。

### JPEG

JPEG 是目前最常见的图片格式，它诞生于 **1992** 年，是一个很古老的格式。它**只支持有损压缩，其压缩算法可以精确控制压缩比，以图像质量换得存储空间**。由于它太过常见，以至于许多移动设备的 CPU 都支持针对它的**硬编码与硬解码**。

### PNG

PNG 诞生在 **1995** 年，比 JPEG 晚几年。它本身的设计目的是替代 GIF 格式，所以它与 GIF 有更多相似的地方。**PNG 只支持无损压缩，所以它的压缩比是有上限的**。相对于 JPEG 和 GIF 来说，它**最大的优势在于支持完整的透明通道**。

## 新兴的图片格式

在上面这些图片格式诞生后，也有不少公司或团体尝试对他们进行改进，或者创造其他更加优秀的图片格式，比如：

- *JPEG 小组*的 `JPEG 2000` ；
- Microsoft 的 `JPEG-XR` ；
- Google 的 `WebP` ；
- 个人开发者发布的 `BPG` 、`FLIF` 等。

它们相对于老牌的那几个图片格式来说有了很大的进步，但出于各种各样的原因，只有少数几个格式能够流行开来。

下面三种就是目前实力比较强的新兴格式了。

### APNG

APNG 是 Mozilla 在 **2008** 年发布的一种图片格式，**旨在替换掉画质低劣的 GIF 动画**。它**实际上只是相当于 PNG 格式的一个扩展**，所以 Mozilla 一直想把它合并到 PNG 标准里面去。

然而 **PNG 开发组并没有接受 APNG 这个扩展**，而是一直在推进它自己的 MNG 动图格式。MNG 格式过于复杂以至于并没有什么系统或浏览器支持，而 APNG 格式由于简单容易实现，目前已经渐渐流行开来。

Mozilla 自己的 Firefox 首先支持了 APNG ，随后苹果的 Safari 也开始有了支持， Chrome 目前也已经尝试开始支持 ，可以说未来前景很好。

### WebP

WebP 是 Google 在 **2010** 年发布的图片格式，**希望以更高的压缩比替代 JPEG** 。它用 *VP8 视频帧内编码*作为其算法基础，取得了不错的压缩效果。

**它支持有损和无损压缩、支持完整的透明通道、也支持多帧动画**，并且没有版权问题，是一种非常理想的图片格式。

借由 Google 在网络世界的影响力，WebP 在几年的时间内已经得到了广泛的应用。看看你手机里的 App ：微博、微信、QQ、淘宝、网易新闻等等，每个 App 里都有 WebP 的身影。Facebook 则更进一步，用 WebP 来显示聊天界面的贴纸动画。

### BPG

BPG 是著名程序员 Fabrice Bellard 在去年 (`2014`年) 发布的一款超高压缩比的图片格式。这个程序员有些人可能感觉面生，但说起他的作品 FFmpeg 、QEMU 大家想必是都知道的。BPG 使用 `HEVC` (即 `H.265` ) 帧内编码作为其算法基础，就这点而言，它毋庸置疑是当下最为先进的图片压缩格式。相对于 JP2、JPEG-XR、WebP 来说，同等体积下 BPG 能提供更高的图像质量。

另外，得益于它本身基于视频编码算法的特性，它能以非常小的文件体积保存多帧动画。 Fabrice Bellard 聪明的地方在于，他知道自己一个人无法得到各大浏览器厂商的支持，所以他还特地开发了 Javascript 版的解码器，任何浏览器只要加载了这个 76KB 大小的 JS 文件，就可以直接显示 BPG 格式的图片了。

目前阻碍它流行的原因就是 HEVC 的版权问题和它较长的编码解码时间。尽管这个图片格式才刚刚发布一年，但已经有不少厂子开始试用了，比如阿里和腾讯。


