# 密码学中的数论<!-- omit in toc -->

- [1. RSA 公钥算法的流程](#1-rsa-公钥算法的流程)
  - [1.1. 密钥生成](#11-密钥生成)
  - [1.2. 加密过程](#12-加密过程)
  - [1.3. 解密过程](#13-解密过程)
- [2. RSA 公钥算法的数论原理](#2-rsa-公钥算法的数论原理)
- [3. RSA 公钥算法 FAQ](#3-rsa-公钥算法-faq)
  - [3.1. RSA 算法用到的数论理论](#31-rsa-算法用到的数论理论)
  - [3.2. 如果 rsa 算法中组成 n 的 p 和 q 泄漏了，敌手如何算出私钥 d ？](#32-如果-rsa-算法中组成-n-的-p-和-q-泄漏了敌手如何算出私钥-d-)
    - [3.2.1. 问题分析](#321-问题分析)
    - [3.2.2. 计算过程](#322-计算过程)
    - [3.2.3. 示例](#323-示例)
    - [3.2.4. 为什么 p 和 q 的泄露如此致命？](#324-为什么-p-和-q-的泄露如此致命)
    - [3.2.5. 如何防止p和q泄露？](#325-如何防止p和q泄露)

## 1. RSA 公钥算法的流程

### 1.1. 密钥生成

1. **选择两个质数**：选择两个不同的大质数 $p$ 和 $q$。计算 $n = p \ast q$。
2. **计算欧拉函数**：计算 ${\varphi(n)} = (p - 1)(q - 1)$。
3. **选择公钥指数**：选择一个整数 $e$， $1 < e < {\varphi(n)}$ ，使得 $e$ 和 ${\varphi(n)}$ 互质，即 $gcd(e, {\varphi(n)}) = 1$。
4. **计算私钥指数**：计算私钥 $d$，使得 $ed \equiv 1\ (mod\ {\varphi(n)})$，即 $d$ 是 $e$ 在模 ${\varphi(n)}$ 下的乘法逆元。（计算 $d$ 时需要使用*扩展欧几里德算法*。）
    - 可以将 $d$ 表示为 $d = e^{-1} \mod \varphi(n)$ 。

此时，公钥为 $(e, n)$，私钥为 $(d, n)$。

### 1.2. 加密过程

TBD

### 1.3. 解密过程

TBD

## 2. RSA 公钥算法的数论原理

TBD

## 3. RSA 公钥算法 FAQ

### 3.1. RSA 算法用到的数论理论

- 伪随机数生成
- 素数检测
- 群论（在有限循环乘法群中执行运算）
- 欧拉公式
- 欧拉定理
- 扩展欧几里德算法（计算私钥 d 时用到）
- 中国剩余定理 (m 和 n 不互质时用到)
- 费马小定理 (m 和 n 不互质时用到)

### 3.2. 如果 rsa 算法中组成 n 的 p 和 q 泄漏了，敌手如何算出私钥 d ？

非常好的问题！ 这个问题直击了RSA算法的安全性核心。

#### 3.2.1. 问题分析

如果攻击者获得了组成模数 $n$ 的两个大素数 $p$ 和 $q$ ，那么他们就可以很容易地计算出私钥 $d$ 。这是因为 RSA 算法的安全性正是建立在大整数分解的困难性之上的。一旦 $n$ 被分解，整个加密体系就会变得脆弱。

#### 3.2.2. 计算过程

**计算欧拉函数 $\varphi(n)$** :

如果已知 $p$ 和 $q$ ，那么欧拉函数 $\varphi(n)$ 可以很容易地计算出来：

$$
\varphi(n) = (p-1)(q-1)
$$

**求解解密指数 $d$** :

根据 RSA 算法的定义，解密指数 $d$ 满足以下同余式：

$$
e \ast d \equiv 1 \pmod{\varphi(n)}
$$

其中， $e$ 是公钥中的加密指数。
我们可以使用扩展欧几里得算法来高效地求解这个线性同余方程，从而得到 $d$ 的值。

#### 3.2.3. 示例

假设：

- $p = 11, q = 13$
- $n = p * q = 143$
- ${\varphi(n)} = (p-1)(q-1) = 120$
- 公钥 $e = 7$

求解 d ：
我们需要找到一个整数 d ，使得：

$$
7d \equiv 1 \pmod{120}
$$

使用**扩展欧几里得算法**，可以得到 $d = 103$ 。

因此，私钥为 $(103, 143)$ 。

#### 3.2.4. 为什么 p 和 q 的泄露如此致命？

- **欧拉函数直接计算**： 一旦知道 $p$ 和 $q$， ${\varphi(n)}$ 的计算变得非常简单。
- **扩展欧几里得算法高效**： 求解线性同余方程是计算机科学中的一个基本问题，扩展欧几里得算法能够在多项式时间内给出解。

#### 3.2.5. 如何防止p和q泄露？

- 选择足够大的素数： $p$ 和 $q$ 的位数越大，分解 $n$ 的难度就越大。实际应用中， $p$ 和 $q$ 的位数通常非常大，例如 $2048$ 位或更高。
- 安全地生成密钥： 使用高质量的随机数生成器来产生 $p$ 和 $q$ 。
- 保护私钥： 私钥必须妥善保管，避免泄露。
