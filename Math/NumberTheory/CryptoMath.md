# 密码学中的数论<!-- omit in toc -->

- [1. 欧拉函数](#1-欧拉函数)
  - [1.1. 欧拉函数的定义](#11-欧拉函数的定义)
  - [1.2. 欧拉函数的性质](#12-欧拉函数的性质)
- [2. 欧拉定理](#2-欧拉定理)
- [3. 费马小定理](#3-费马小定理)
- [4. 中国剩余定理](#4-中国剩余定理)
- [5. 扩展欧几里德算法](#5-扩展欧几里德算法)
- [7. RSA 公钥算法的流程](#7-rsa-公钥算法的流程)
  - [7.1. 密钥生成](#71-密钥生成)
  - [7.2. 加密过程](#72-加密过程)
  - [7.3. 解密过程](#73-解密过程)
- [8. RSA 公钥算法的数论原理](#8-rsa-公钥算法的数论原理)
- [9. RSA 公钥算法 FAQ](#9-rsa-公钥算法-faq)
  - [9.1. RSA 算法用到的数论理论](#91-rsa-算法用到的数论理论)
  - [9.2. 如果 rsa 算法中组成 n 的 p 和 q 泄漏了，敌手如何算出私钥 d ？](#92-如果-rsa-算法中组成-n-的-p-和-q-泄漏了敌手如何算出私钥-d-)

## 1. 欧拉函数

### 1.1. 欧拉函数的定义

**对于正整数 $n$，欧拉函数 $\varphi(n)$ 表示小于等于 $n$ 的正整数中与 $n$ 互质的数的个数。**

### 1.2. 欧拉函数的性质

1. **若 $p$ 为质数，那么 $\varphi(p) = p-1$**

   - （因为 $p$ 为质数，所以小于 $p$ 的所有正整数都与 $p$ 互质。）

2. **如果 $m$ 和 $n$ 互质，那么 $\varphi(mn) = \varphi(m) + \varphi(n)$**

## 2. 欧拉定理

> 这里指的是数论中的欧拉定理。

如果 $a$ 和 $n$ 互质，那么 $a^{\varphi(n)} \equiv 1 \pmod{n}$

## 3. 费马小定理

## 4. 中国剩余定理

## 5. 扩展欧几里德算法

## 7. RSA 公钥算法的流程

### 7.1. 密钥生成

1. **选择两个质数**：选择两个不同的大质数 $p$ 和 $q$。计算 $n = p \ast q$。
2. **计算欧拉函数**：计算 ${\varphi(n)} = (p - 1)(q - 1)$。
3. **选择公钥指数**：选择一个整数 $e$， $1 < e < {\varphi(n)}$ ，使得 $e$ 和 ${\varphi(n)}$ 互质，即 $gcd(e, {\varphi(n)}) = 1$。
4. **计算私钥指数**：计算私钥 $d$，使得 $ed ≡ 1\ (mod\ {\varphi(n)})$，即 $d$ 是 $e$ 在模 ${\varphi(n)}$ 下的乘法逆元。（计算 $d$ 时需要使用*扩展欧几里德算法*。）

此时，公钥为 $(e, n)$，私钥为 $(d, n)$。

### 7.2. 加密过程

TBD

### 7.3. 解密过程

TBD

## 8. RSA 公钥算法的数论原理

TBD

## 9. RSA 公钥算法 FAQ

### 9.1. RSA 算法用到的数论理论

- 伪随机数生成
- 素数检测
- 群论（在有限循环乘法群中执行运算）
- 欧拉公式
- 欧拉定理
- 扩展欧几里德算法（计算私钥 d 时用到）
- 中国剩余定理 (m 和 n 不互质时用到)
- 费马小定理 (m 和 n 不互质时用到)

### 9.2. 如果 rsa 算法中组成 n 的 p 和 q 泄漏了，敌手如何算出私钥 d ？
